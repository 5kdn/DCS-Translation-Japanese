var e=(e,r,t)=>((e,r,t={})=>{let o=`${e}=${r}`;if(e.startsWith("__Secure-")&&!t.secure)throw new Error("__Secure- Cookie must have Secure attributes");if(e.startsWith("__Host-")){if(!t.secure)throw new Error("__Host- Cookie must have Secure attributes");if("/"!==t.path)throw new Error('__Host- Cookie must have Path attributes with "/"');if(t.domain)throw new Error("__Host- Cookie must not have Domain attributes")}if(t&&"number"==typeof t.maxAge&&t.maxAge>=0){if(t.maxAge>3456e4)throw new Error("Cookies Max-Age SHOULD NOT be greater than 400 days (34560000 seconds) in duration.");o+="; Max-Age="+(0|t.maxAge)}if(t.domain&&"host"!==t.prefix&&(o+=`; Domain=${t.domain}`),t.path&&(o+=`; Path=${t.path}`),t.expires){if(t.expires.getTime()-Date.now()>3456e7)throw new Error("Cookies Expires SHOULD NOT be greater than 400 days (34560000 seconds) in the future.");o+=`; Expires=${t.expires.toUTCString()}`}if(t.httpOnly&&(o+="; HttpOnly"),t.secure&&(o+="; Secure"),t.sameSite&&(o+=`; SameSite=${t.sameSite.charAt(0).toUpperCase()+t.sameSite.slice(1)}`),t.priority&&(o+=`; Priority=${t.priority.charAt(0).toUpperCase()+t.priority.slice(1)}`),t.partitioned){if(!t.secure)throw new Error("Partitioned Cookie must have Secure attributes");o+="; Partitioned"}return o})(e,r=encodeURIComponent(r),t),r=(e,r)=>{for(const[t,o]of Object.entries(r)){const r=new RegExp("/:"+t+"(?:{[^/]+})?\\??");e=e.replace(r,o?`/${o}`:"")}return e},t=e=>{const r=new URLSearchParams;for(const[t,o]of Object.entries(e))if(void 0!==o)if(Array.isArray(o))for(const e of o)r.append(t,e);else r.set(t,o);return r},o=e=>/^https?:\/\/[^\/]+?\/index(?=\?|$)/.test(e)?e.replace(/\/index(?=\?|$)/,"/"):e.replace(/\/index(?=\?|$)/,"");function s(e){return"object"==typeof e&&null!==e&&!Array.isArray(e)}function a(e,r){if(!s(e)&&!s(r))return r;const t={...e};for(const o in r){const e=r[o];s(t[o])&&s(e)?t[o]=a(t[o],e):t[o]=e}return t}var i=(e,r)=>new Proxy(()=>{},{get(t,o){if("string"==typeof o&&"then"!==o)return i(e,[...r,o])},apply:(t,o,s)=>e({path:r,args:s})}),n=class{url;method;queryParams=void 0;pathParams={};rBody;cType=void 0;constructor(e,r){this.url=e,this.method=r}fetch=async(s,a)=>{if(s){if(s.query&&(this.queryParams=t(s.query)),s.form){const e=new FormData;for(const[r,t]of Object.entries(s.form))if(Array.isArray(t))for(const o of t)e.append(r,o);else e.append(r,t);this.rBody=e}s.json&&(this.rBody=JSON.stringify(s.json),this.cType="application/json"),s.param&&(this.pathParams=s.param)}let i=this.method.toUpperCase();const n={...s?.header,..."function"==typeof a?.headers?await a.headers():a?.headers};if(s?.cookie){const r=[];for(const[t,o]of Object.entries(s.cookie))r.push(e(t,o,{path:"/"}));n.Cookie=r.join(",")}this.cType&&(n["Content-Type"]=this.cType);const c=new Headers(n??void 0);let h=this.url;h=o(h),h=r(h,this.pathParams),this.queryParams&&(h=h+"?"+this.queryParams.toString()),i=this.method.toUpperCase();const p=!("GET"===i||"HEAD"===i);return(a?.fetch||fetch)(h,{body:p?this.rBody:void 0,method:i,headers:c,...a?.init})}},c=(e,s)=>i(function i(c){const h=[...c.path],p=h.slice(-3).reverse();if("toString"===p[0])return"name"===p[1]?p[2]||"":i.toString();if("valueOf"===p[0])return"name"===p[1]?p[2]||"":i;let u="";if(/^\$/.test(p[0])){const e=h.pop();e&&(u=e.replace(/^\$/,""))}const f=h.join("/"),m=((e,r)=>(e=e.replace(/\/+$/,""),(e+="/")+r.replace(/^\/+/,"")))(e,f);if("url"===u){let e=m;return c.args[0]&&(c.args[0].param&&(e=r(m,c.args[0].param)),c.args[0].query&&(e=e+"?"+t(c.args[0].query).toString())),e=o(e),new URL(e)}if("ws"===u){const e=((e,r)=>{switch(r){case"ws":return e.replace(/^http/,"ws");case"http":return e.replace(/^ws/,"http")}})(c.args[0]&&c.args[0].param?r(m,c.args[0].param):m,"ws"),t=new URL(e),o=c.args[0]?.query;o&&Object.entries(o).forEach(([e,r])=>{Array.isArray(r)?r.forEach(r=>t.searchParams.append(e,r)):t.searchParams.set(e,r)});return((...e)=>void 0!==s?.webSocket&&"function"==typeof s.webSocket?s.webSocket(...e):new WebSocket(...e))(t.toString())}const y=new n(m,u);if(u){s??={};const e=a(s,{...c.args[1]});return y.fetch(c.args[0],e)}return y},[]);export{c as h};
